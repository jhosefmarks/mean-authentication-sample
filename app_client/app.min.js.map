{"version":3,"sources":["app.min.js"],"names":["config","$routeProvider","$locationProvider","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","authentication","$on","event","nextRoute","currentRoute","path","isLoggedIn","angular","module","homeCtrl","console","log","profileCtrl","meanData","vm","this","user","getProfile","success","data","error","e","$inject","loginCtrl","credentials","email","password","onSubmit","login","err","alert","message","then","registerCtrl","name","register","$http","$window","saveToken","getToken","currentUser","logout","token","localStorage","payload","split","atob","JSON","parse","exp","Date","now","post","get","removeItem","service","headers","Authorization","navigationCtrl","navigation","restrict","directive"],"mappings":"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","file":"app.min.js","sourcesContent":["/*global angular, alert */\r\n\r\n(function () {\r\n\r\n    'use strict';\r\n\r\n    angular.module('meanApp', ['ngRoute']);\r\n\r\n    function config($routeProvider, $locationProvider) {\r\n        $routeProvider\r\n            .when('/', {\r\n                templateUrl: 'home/home.view.html',\r\n                controller: 'homeCtrl',\r\n                controllerAs: 'vm'\r\n            })\r\n            .when('/register', {\r\n                templateUrl: '/auth/register/register.view.html',\r\n                controller: 'registerCtrl',\r\n                controllerAs: 'vm'\r\n            })\r\n            .when('/login', {\r\n                templateUrl: '/auth/login/login.view.html',\r\n                controller: 'loginCtrl',\r\n                controllerAs: 'vm'\r\n            })\r\n            .when('/profile', {\r\n                templateUrl: '/profile/profile.view.html',\r\n                controller: 'profileCtrl',\r\n                controllerAs: 'vm'\r\n            })\r\n            .otherwise({redirectTo: '/'});\r\n\r\n        // use the HTML5 History API\r\n        $locationProvider.html5Mode(true);\r\n    }\r\n\r\n    function run($rootScope, $location, authentication) {\r\n        $rootScope.$on('$routeChangeStart', function (event, nextRoute, currentRoute) {\r\n            if ($location.path() === '/profile' && !authentication.isLoggedIn()) {\r\n                $location.path('/');\r\n            }\r\n        });\r\n    }\r\n  \r\n    angular\r\n        .module('meanApp')\r\n        .config(['$routeProvider', '$locationProvider', config])\r\n        .run(['$rootScope', '$location', 'authentication', run]);\r\n\r\n}());\n/*global angular, console */\r\n\r\n(function () {\r\n\r\n    'use strict';\r\n\r\n    function homeCtrl() {\r\n        console.log('Home controller is running');\r\n    }\r\n    \r\n    angular\r\n        .module('meanApp')\r\n        .controller('homeCtrl', homeCtrl);\r\n\r\n}());\n/*global angular, console */\r\n\r\n(function () {\r\n\r\n    'use strict';\r\n\r\n    function profileCtrl($location, meanData) {\r\n        var vm = this;\r\n\r\n        vm.user = {};\r\n\r\n        meanData.getProfile()\r\n            .success(function (data) {\r\n                vm.user = data;\r\n            })\r\n            .error(function (e) {\r\n                console.log(e);\r\n            });\r\n    }\r\n\r\n    angular\r\n        .module('meanApp')\r\n        .controller('profileCtrl', profileCtrl);\r\n\r\n    profileCtrl.$inject = ['$location', 'meanData'];\r\n    \r\n}());\n/*global angular, alert */\r\n\r\n(function () {\r\n\r\n    'use strict';\r\n\r\n    function loginCtrl($location, authentication) {\r\n        var vm = this;\r\n\r\n        vm.credentials = {\r\n            email: \"\",\r\n            password: \"\"\r\n        };\r\n\r\n        vm.onSubmit = function () {\r\n            authentication.login(vm.credentials)\r\n                .error(function (err) {\r\n                    alert(err.message);\r\n                })\r\n                .then(function () {\r\n                    $location.path('profile');\r\n                });\r\n        };\r\n\r\n    }\r\n\r\n    angular\r\n        .module('meanApp')\r\n        .controller('loginCtrl', loginCtrl);\r\n\r\n    loginCtrl.$inject = ['$location', 'authentication'];\r\n\r\n}());\n/*global angular, console, alert */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    function registerCtrl($location, authentication) {\r\n        var vm = this;\r\n\r\n        vm.credentials = {\r\n            name: \"\",\r\n            email: \"\",\r\n            password: \"\"\r\n        };\r\n\r\n        vm.onSubmit = function () {\r\n\r\n            authentication.register(vm.credentials)\r\n                .error(function (err) {\r\n                    alert(err);\r\n                })\r\n                .then(function () {\r\n                    $location.path('profile');\r\n                });\r\n        };\r\n\r\n    }\r\n\r\n    registerCtrl.$inject = ['$location', 'authentication'];\r\n\r\n    angular\r\n        .module('meanApp')\r\n        .controller('registerCtrl', registerCtrl);\r\n\r\n}());\n/*global angular */\r\n\r\n(function () {\r\n\r\n    'use strict';\r\n\r\n    function authentication($http, $window, $location) {\r\n\r\n        var saveToken,\r\n            getToken,\r\n            isLoggedIn,\r\n            currentUser,\r\n            register,\r\n            login,\r\n            logout;\r\n\r\n        saveToken = function (token) {\r\n            $window.localStorage['mean-token'] = token;\r\n        };\r\n\r\n        getToken = function () {\r\n            return $window.localStorage['mean-token'];\r\n        };\r\n\r\n        isLoggedIn = function () {\r\n            var token = getToken(),\r\n                payload;\r\n\r\n            if (token && token !== 'null') {\r\n                payload = token.split('.')[1];\r\n                payload = $window.atob(payload);\r\n                payload = JSON.parse(payload);\r\n\r\n                return payload.exp > Date.now() / 1000;\r\n            } else {\r\n                return false;\r\n            }\r\n        };\r\n\r\n        currentUser = function () {\r\n            var token,\r\n                payload;\r\n\r\n            if (isLoggedIn()) {\r\n                token = getToken();\r\n                payload = token.split('.')[1];\r\n\r\n                payload = $window.atob(payload);\r\n                payload = JSON.parse(payload);\r\n\r\n                return {\r\n                    email: payload.email,\r\n                    name: payload.name\r\n                };\r\n            }\r\n        };\r\n\r\n        register = function (user) {\r\n            return $http.post('/api/register', user).success(function (data) {\r\n                saveToken(data.token);\r\n            });\r\n        };\r\n\r\n        login = function (user) {\r\n            return $http.post('/api/login', user).success(function (data) {\r\n                saveToken(data.token);\r\n            });\r\n        };\r\n\r\n        logout = function () {\r\n            return $http.get('/api/logout', currentUser).success(function (data) {\r\n                //saveToken(data.token);\r\n                $window.localStorage.removeItem('mean-token');\r\n\r\n                $location.path('/');\r\n            });\r\n        };\r\n\r\n        return {\r\n            currentUser : currentUser,\r\n            saveToken : saveToken,\r\n            getToken : getToken,\r\n            isLoggedIn : isLoggedIn,\r\n            register : register,\r\n            login : login,\r\n            logout : logout\r\n        };\r\n    }\r\n\r\n    authentication.$inject = ['$http', '$window', '$location'];\r\n\r\n    angular\r\n        .module('meanApp')\r\n        .service('authentication', authentication);\r\n\r\n}());\n/*global angular */\r\n\r\n(function () {\r\n\r\n    'use strict';\r\n\r\n    function meanData($http, authentication) {\r\n\r\n        var getProfile = function () {\r\n            return $http.get('/api/profile', {\r\n                headers: {\r\n                    Authorization: 'Bearer ' + authentication.getToken()\r\n                }\r\n            });\r\n        };\r\n\r\n        return {\r\n            getProfile : getProfile\r\n        };\r\n    }\r\n\r\n    angular\r\n        .module('meanApp')\r\n        .service('meanData', meanData);\r\n\r\n    meanData.$inject = ['$http', 'authentication'];\r\n    \r\n}());\n/*global angular */\r\n\r\n(function () {\r\n\r\n    'use strict';\r\n\r\n    function navigationCtrl($location, authentication) {\r\n        var vm = this;\r\n\r\n        vm.isLoggedIn = authentication.isLoggedIn();\r\n\r\n        vm.currentUser = authentication.currentUser();\r\n\r\n        vm.logout = authentication.logout;\r\n\r\n    }\r\n\r\n    angular\r\n        .module('meanApp')\r\n        .controller('navigationCtrl', navigationCtrl);\r\n\r\n    navigationCtrl.$inject = ['$location', 'authentication'];\r\n\r\n}());\n/*global angular */\r\n\r\n(function () {\r\n\r\n    'use strict';\r\n\r\n    function navigation () {\r\n        return {\r\n            restrict: 'EA',\r\n            templateUrl: '/common/directives/navigation/navigation.template.html',\r\n            controller: 'navigationCtrl as navvm'\r\n        };\r\n    }\r\n\r\n    angular\r\n        .module('meanApp')\r\n        .directive('navigation', navigation);\r\n\r\n}());"],"sourceRoot":"/source/"}